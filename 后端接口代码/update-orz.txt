import cloud from '@lafjs/cloud'
import { ObjectId } from 'mongodb';

export default async function (ctx: FunctionContext) {
  const db = cloud.mongo.db;
  const id = ctx.body.id;

  if (!id){
    return{
      hao:false,
      message:"nonono"
    };
  }
const collection = db.collection('list');
const document = await collection.findOne({_id:new ObjectId(id)});
if(!document){
return{
  hao:false,
  message:"妹找到啊"
};

}

 const updateResult =await collection.updateOne(
  { _id:new ObjectId(id)},
   { $set:{ isCompleted: !document.isCompleted }}
 );
if(updateResult.modifiedCount===1){
  return{
    hao:true,
    message:"666"

  };
}
else {
  return{
    hao:false,
    message:"失败li"
  };
}
}